

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>功能演示一 - 上传组件</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
    <script type="text/javascript" src="../../lib/jquery.min.js"></script>
</head>
<body>
<style>
    .layui-upload-img{width: 150px; height: 120px; margin: 0 10px 10px 0;}
</style>


<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div style="position: absolute;left:40%;">
            <div class="layui-col-md12">
                <div class="layui-card">
                    <div class="layui-card-body"  style="padding: 15px;">
                        <!--图片-->
                        <!--展示图片的也可以展示图片名，但要修改下面备注展示文件名哪里-->
                        <!--<input id="fileName" type="text" lay-verify="fileName"-->
                               <!--autocomplete="off" class="layui-input" disabled>-->
                        <img class="layui-upload-img" id="test-upload-normal-img">
                        <p id="test-upload-demoText"></p>
                        <!--隐藏输入框 用来存放上传后图片路径&ndash;&gt;-->
                        <input id="credential_hide" name="credentialOne" type="hidden" lay-verify="credentialOne"
                               autocomplete="off" class="layui-input">
                        <!--隐藏按钮 上传-->
                        <button id="upload_img" type="button" hidden></button>
                        <button class="layui-btn" id="preview_img" type="button">
                            上传图片
                        </button>



                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品名</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>

                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">类型</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">规格</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">计量单位</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">库存</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品折扣</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>

                        </div>
                        <div class="layui-form-item">
                            <div class="layui-inline">
                                <label class="layui-form-label">商品价格</label>
                                <div class="layui-input-inline">
                                    <input type="tel" name="phone"  autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <button class="layui-btn layui-btn-normal btn-submit" id="fake">
                            确定
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script src="../../layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '../../layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index']);

    //普通图片上传
    layui.use(['form', 'layer', 'upload'], function () {
        $ = layui.jquery;
        var form = layui.form;
        layer = layui.layer,
            upload = layui.upload;

        /*上传图片*/
        upload.render({
            elem: '#preview_img'
            , url: '/uploadFile.lovo'
            , size: 1024
            , auto: false //不自动上传
            , bindAction: '#upload_img' //上传绑定到隐藏按钮
            , choose: function (obj) {
                //预读本地文件
                obj.preview(function (index, file, result) {
                    // $('#fileName').val(file.name);  //展示文件名
                    $('#test-upload-normal-img').attr('src', result); //图片链接（base64）

                })
            }
            , done: function (res) {
                $('#credential_hide').val(res.msg); //隐藏输入框赋值
                $('#submitForm').click(); //上传成功后单击隐藏的提交按钮
            }
            , error: function (index, upload) {
                layer.msg('上传失败！' + index, {icon: 5});
            }
        });

        //确定按钮点击事件，把返回的照片重命名保存到隐藏表单点击确定
        //和其他数据一起传到后台保存
        $('#fake').click(function () {
            $(this).attr({'disabled': 'disabled'});
            $('#upload_img').click();//单击隐藏的上传按钮
        });

        /*监听提交*/
        form.on('submit(add_recharge_submit)', function (data) {
            addRecharge(data.field);
            return false;
        });
    });
</script>
</body>
</html>